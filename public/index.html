<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CO HAIR æ–‡æ¡ˆç”Ÿæˆå™¨</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f6f6f6; }
    h1 { color: #333; text-align: center; }
    .container { background: white; padding: 20px; border-radius: 8px; max-width: 500px; margin: auto; }
    button, select, input { margin-top: 10px; padding: 10px; width: 100%; font-size: 16px; }
    .platforms img { width: 40px; margin: 10px; cursor: pointer; }
    .output-title { font-weight: bold; font-size: 18px; margin-top: 20px; }
    .output-body { white-space: pre-wrap; background: #eee; padding: 10px; border-radius: 6px; margin-top: 10px; }
    .loading { text-align: center; font-style: italic; color: #777; margin-top: 20px; }
    .error { color: red; font-weight: bold; text-align: center; margin-top: 20px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ§  CO HAIR å¿«é€Ÿå‘æ–‡åŠ©æ‰‹</h1>
    
    <label>é€‰æ‹©è¯­è¨€ï¼š</label>
    <select id="language">
      <option value="zh">ä¸­æ–‡</option>
      <option value="en">English</option>
    </select>

    <label>è¾“å…¥å…³é”®è¯ï¼ˆå¦‚ç†å‘å¸ˆåå­—ï¼‰ï¼š</label>
    <input type="text" id="keywords" placeholder="ä¾‹ï¼šyk æˆ– eilyn"/>

    <button id="generateBtn" onclick="generate()" disabled>åŠ è½½ä¸­...</button>

    <div id="status" class="loading"></div>
    <div class="output-title" id="title"></div>
    <div class="output-body" id="output"></div>

    <div class="platforms">
      <h3>ç‚¹å¹³å°å›¾æ ‡ç›´æ¥è·³è½¬å‘æ–‡ï¼š</h3>
      <a id="fb" target="_blank"><img src="https://cdn-icons-png.flaticon.com/512/124/124010.png" /></a>
      <a id="ig" target="_blank"><img src="https://cdn-icons-png.flaticon.com/512/2111/2111463.png" /></a>
      <a id="xhs" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/c/c1/XiaohongshuLOGO.png" /></a>
      <a id="tt" target="_blank"><img src="https://static.vecteezy.com/system/resources/previews/016/716/485/large_2x/tiktok-icon-free-png.png" /></a>
    </div>
  </div>

  <script>
    const btn = document.getElementById("generateBtn");
    window.addEventListener("DOMContentLoaded", () => {
      btn.disabled = false;
      btn.innerText = "ç”Ÿæˆæ–‡æ¡ˆ";
    });

    async function generate() {
      const language = document.getElementById("language").value;
      const keywords = document.getElementById("keywords").value.trim();
      const titleEl = document.getElementById("title");
      const outputEl = document.getElementById("output");
      const statusEl = document.getElementById("status");

      if (!keywords) {
        statusEl.innerHTML = "<div class='error'>â—è¯·è¾“å…¥å…³é”®è¯</div>";
        return;
      }

      // æ¸…ç©ºå†…å®¹
      titleEl.textContent = "";
      outputEl.textContent = "";
      statusEl.innerHTML = "â³ æ­£åœ¨ç”Ÿæˆæ–‡æ¡ˆï¼Œè¯·ç¨ç­‰...";
      btn.disabled = true;
      btn.innerText = "ç”Ÿæˆä¸­...";

      try {
        const res = await fetch("/api/generate", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            language,
            prompt: keywords, // âœ… ä¿®æ­£å­—æ®µåç§°ï¼
            style: "çœŸå®" // é»˜è®¤é£æ ¼ï¼Œå¯ä»¥æ‰©å±•
          })
        });

        const data = await res.json();

        if (data.title && data.result) {
          titleEl.textContent = data.title;
          outputEl.textContent = data.result;
          statusEl.innerHTML = "";

          const encodedText = encodeURIComponent(`${data.title}\n${data.result}`);
          document.getElementById("fb").href = `https://www.facebook.com/sharer/sharer.php?u=&quote=${encodedText}`;
          document.getElementById("ig").href = `https://www.instagram.com/`;
          document.getElementById("xhs").href = `https://www.xiaohongshu.com/`;
          document.getElementById("tt").href = `https://www.tiktok.com/upload?caption=${encodedText}`;
        } else {
          throw new Error(data.error || "æ²¡æœ‰è¿”å›æ–‡æ¡ˆ");
        }
      } catch (err) {
        statusEl.innerHTML = `<div class='error'>âŒ ç”Ÿæˆå¤±è´¥ï¼š${err.message}</div>`;
      } finally {
        btn.disabled = false;
        btn.innerText = "ç”Ÿæˆæ–‡æ¡ˆ";
      }
    }
  </script>
</body>
</html>
